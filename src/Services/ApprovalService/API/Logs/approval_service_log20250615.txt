2025-06-15 14:31:30.412 +09:00 [DBG] Connection id "0HNDB9VV92HGR" accepted.
2025-06-15 14:31:30.494 +09:00 [DBG] Connection id "0HNDB9VV92HGR" started.
2025-06-15 14:31:30.530 +09:00 [DBG] Connection 0HNDB9VV92HGR established using the following protocol: "Tls12"
2025-06-15 14:31:30.536 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20507 - null null
2025-06-15 14:31:30.539 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20507'
2025-06-15 14:31:30.540 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20507'
2025-06-15 14:31:30.541 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 14:31:30.545 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 14:31:30.546 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 14:31:30.547 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 14:31:30.547 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 14:31:30.547 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 14:31:30.548 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 14:31:30.549 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 14:31:30.549 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 14:31:30.550 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 14:31:30.558 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 14:31:30.559 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 14:31:30.559 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 14:31:30.560 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 14:31:30.560 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 14:31:30.560 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 14:31:30.561 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 14:31:30.575 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 14:31:30.588 +09:00 [DBG] Creating DbConnection.
2025-06-15 14:31:30.591 +09:00 [DBG] Created DbConnection. (3ms).
2025-06-15 14:31:30.591 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 14:31:30.598 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 14:31:30.600 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 14:31:30.600 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-15 14:31:30.601 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-06-15 14:31:30.601 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 14:31:30.606 +09:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 14:31:30.607 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.608 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.608 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.608 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.608 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.609 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.609 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.609 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:30.610 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 14:31:30.610 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 3ms reading results.
2025-06-15 14:31:30.610 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 14:31:30.610 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 14:31:30.610 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 14:31:30.610 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 14:31:30.610 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 14:31:30.610 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 14:31:30.611 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 14:31:30.611 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 14:31:30.612 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 62.9819ms
2025-06-15 14:31:30.612 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 14:31:30.612 +09:00 [DBG] Connection id "0HNDB9VV92HGR" completed keep alive response.
2025-06-15 14:31:30.612 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 14:31:30.613 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 14:31:30.613 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 14:31:30.613 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20507 - 200 null application/json; charset=utf-8 77.484ms
2025-06-15 14:31:39.106 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - null null
2025-06-15 14:31:39.107 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 14:31:39.107 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)' with route pattern 'api/Approval/my-approvals/{approverId}' is valid for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 14:31:39.108 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 14:31:39.115 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 14:31:39.116 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 14:31:39.118 +09:00 [INF] Route matched with {action = "GetMyApprovals", controller = "Approval"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyApprovals(System.String) on controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API).
2025-06-15 14:31:39.118 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 14:31:39.119 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 14:31:39.119 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 14:31:39.119 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 14:31:39.120 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 14:31:39.121 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 14:31:39.123 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 14:31:39.123 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' ...
2025-06-15 14:31:39.123 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' using the name 'approverId' in request data ...
2025-06-15 14:31:39.123 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 14:31:39.124 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 14:31:39.124 +09:00 [DBG] Attempting to validate the bound parameter 'approverId' of type 'System.String' ...
2025-06-15 14:31:39.124 +09:00 [DBG] Done attempting to validate the bound parameter 'approverId' of type 'System.String'.
2025-06-15 14:31:39.131 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 14:31:39.134 +09:00 [DBG] Creating DbConnection.
2025-06-15 14:31:39.135 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 14:31:39.135 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 14:31:39.136 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 14:31:39.136 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 14:31:39.136 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 14:31:39.136 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 14:31:39.136 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 14:31:39.139 +09:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 14:31:39.139 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.139 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.140 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.140 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.140 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.140 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.140 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.140 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.141 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.141 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 14:31:39.141 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 14:31:39.141 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 2ms reading results.
2025-06-15 14:31:39.141 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 14:31:39.142 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 14:31:39.142 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 14:31:39.142 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 14:31:39.142 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 14:31:39.147 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 14:31:39.152 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 14:31:39.152 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 14:31:39.159 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API) in 39.0372ms
2025-06-15 14:31:39.159 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 14:31:39.159 +09:00 [DBG] Connection id "0HNDB9VV92HGR" completed keep alive response.
2025-06-15 14:31:39.159 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 14:31:39.160 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 14:31:39.160 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 14:31:39.160 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - 200 null application/json; charset=utf-8 54.5052ms
2025-06-15 14:33:13.973 +09:00 [DBG] Connection id "0HNDB9VV92HGR" received FIN.
2025-06-15 14:33:13.976 +09:00 [DBG] Connection id "0HNDB9VV92HGR" disconnecting.
2025-06-15 14:33:13.977 +09:00 [DBG] Connection id "0HNDB9VV92HGR" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-15 14:33:13.980 +09:00 [DBG] Connection id "0HNDB9VV92HGR" stopped.
2025-06-15 20:06:43.547 +09:00 [INF] Application is shutting down...
2025-06-15 20:06:43.559 +09:00 [DBG] Hosting stopping
2025-06-15 20:06:43.635 +09:00 [DBG] Hosting stopped
2025-06-15 20:20:39.986 +09:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-15 20:20:40.114 +09:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-06-15 20:20:40.393 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:20:40.400 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:20:40.407 +09:00 [DBG] Created DbConnection. (5ms).
2025-06-15 20:20:40.410 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.418 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.421 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.423 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:20:40.425 +09:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-06-15 20:20:40.426 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:20:40.427 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:20:40.433 +09:00 [DBG] Created DbCommand for 'ExecuteScalar' (4ms).
2025-06-15 20:20:40.434 +09:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-06-15 20:20:40.434 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.435 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.437 +09:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:20:40.456 +09:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:20:40.457 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.458 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (1ms).
2025-06-15 20:20:40.461 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:20:40.461 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:20:40.461 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.461 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.461 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.462 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:20:40.462 +09:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-06-15 20:20:40.462 +09:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-06-15 20:20:40.462 +09:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-06-15 20:20:40.462 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.462 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.462 +09:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:20:40.463 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:20:40.463 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.463 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:20:40.486 +09:00 [DBG] Compiling query expression: 
'DbSet<ApprovalRequest>()
    .Any()'
2025-06-15 20:20:40.581 +09:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM ApprovalRequests AS a)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM ApprovalRequests AS a), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: ApprovalService.Infrastructure.Persistence.ApprovalDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-15 20:20:40.593 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.593 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.593 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:20:40.593 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:20:40.593 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:20:40.594 +09:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ApprovalRequests" AS "a")
2025-06-15 20:20:40.595 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ApprovalRequests" AS "a")
2025-06-15 20:20:40.597 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.597 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 2ms reading results.
2025-06-15 20:20:40.598 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:20:40.598 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:20:40.599 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:20:40.599 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:20:40.599 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:20:40.601 +09:00 [DBG] Hosting starting
2025-06-15 20:20:40.638 +09:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-06-15 20:20:40.639 +09:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-15 20:20:40.953 +09:00 [INF] Now listening on: https://localhost:5001
2025-06-15 20:20:40.953 +09:00 [INF] Now listening on: http://localhost:5229
2025-06-15 20:20:40.953 +09:00 [DBG] Loaded hosting startup assembly ApprovalService.API
2025-06-15 20:20:40.953 +09:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-15 20:20:40.955 +09:00 [INF] Hosting environment: Development
2025-06-15 20:20:40.956 +09:00 [INF] Content root path: /Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API
2025-06-15 20:20:40.956 +09:00 [DBG] Hosting started
2025-06-15 20:32:19.137 +09:00 [DBG] Connection id "0HNDC014PLVUV" accepted.
2025-06-15 20:32:19.139 +09:00 [DBG] Connection id "0HNDC014PLVUV" started.
2025-06-15 20:32:19.174 +09:00 [DBG] Connection 0HNDC014PLVUV established using the following protocol: "Tls12"
2025-06-15 20:32:19.219 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - null null
2025-06-15 20:32:19.251 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:32:19.254 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)' with route pattern 'api/Approval/my-approvals/{approverId}' is valid for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:32:19.256 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:32:19.274 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:32:19.275 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:32:19.304 +09:00 [INF] Route matched with {action = "GetMyApprovals", controller = "Approval"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyApprovals(System.String) on controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API).
2025-06-15 20:32:19.305 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:32:19.306 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:32:19.307 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:32:19.307 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:32:19.307 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:32:19.308 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:32:19.311 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:32:19.317 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' ...
2025-06-15 20:32:19.319 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' using the name 'approverId' in request data ...
2025-06-15 20:32:19.320 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:32:19.320 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:32:19.320 +09:00 [DBG] Attempting to validate the bound parameter 'approverId' of type 'System.String' ...
2025-06-15 20:32:19.322 +09:00 [DBG] Done attempting to validate the bound parameter 'approverId' of type 'System.String'.
2025-06-15 20:32:22.046 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:32:22.073 +09:00 [DBG] Compiling query expression: 
'DbSet<ApprovalRequest>()
    .Where(approval => approval.Steps
        .Any(step => step.ApproverEmployeeNumber == __userId_0))
    .Include(approval => approval.Steps)
    .Select(r => new ApprovalRequestWithCurrentStepDto{ 
        ApprovalId = r.ApprovalId, 
        RequestTitle = r.RequestTitle, 
        RequestedAt = r.RequestedAt, 
        RespondedAt = r.RespondedAt, 
        ApplicantEmployeeNumber = r.ApplicantEmployeeNumber, 
        ApplicantDepartment = r.ApplicantDepartment, 
        ApplicantName = r.ApplicantName, 
        ApplicantPosition = r.ApplicantPosition, 
        Status = r.Status, 
        Steps = r.Steps, 
        CurrentStep = r.CurrentStep, 
        CurrentApproverName = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverName)
            .FirstOrDefault(), 
        CurrentApproverEmployeeNumber = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverEmployeeNumber)
            .FirstOrDefault(), 
        CurrentActionStatus = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ActionStatus)
            .FirstOrDefault() 
    }
    )'
2025-06-15 20:32:22.163 +09:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApprovalRequestWithCurrentStepDto>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> 8
            9 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: ApprovalStep.ActionDate (DateTime?), 10], [Property: ApprovalStep.ActionStatus (string), 11], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 12], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 13], [Property: ApprovalStep.ApproverName (string), 14], [Property: ApprovalStep.Comment (string), 15], [Property: ApprovalStep.Department (string), 16], [Property: ApprovalStep.IsFinalApprover (bool) Required, 17], [Property: ApprovalStep.Position (string), 18], [Property: ApprovalStep.Sequence (int) Required, 19], [Property: ApprovalStep.StepType (string), 20] }
            10 -> 9
            11 -> 21
            12 -> 22
            13 -> 23
            14 -> 24
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantDepartment, a.ApplicantName, a.ApplicantPosition, a.Status, a1.StepId, a1.ActionDate, a1.ActionStatus, a1.ApprovalId, a1.ApproverEmployeeNumber, a1.ApproverName, a1.Comment, a1.Department, a1.IsFinalApprover, a1.Position, a1.Sequence, a1.StepType, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE EXISTS (
            SELECT 1
            FROM ApprovalSteps AS a0
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a0.ApprovalId)) && (a0.ApproverEmployeeNumber == @__userId_0))
        ORDER BY a.ApprovalId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> 8
            9 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: ApprovalStep.ActionDate (DateTime?), 10], [Property: ApprovalStep.ActionStatus (string), 11], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 12], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 13], [Property: ApprovalStep.ApproverName (string), 14], [Property: ApprovalStep.Comment (string), 15], [Property: ApprovalStep.Department (string), 16], [Property: ApprovalStep.IsFinalApprover (bool) Required, 17], [Property: ApprovalStep.Position (string), 18], [Property: ApprovalStep.Sequence (int) Required, 19], [Property: ApprovalStep.StepType (string), 20] }
            10 -> 9
            11 -> 21
            12 -> 22
            13 -> 23
            14 -> 24
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantDepartment, a.ApplicantName, a.ApplicantPosition, a.Status, a1.StepId, a1.ActionDate, a1.ActionStatus, a1.ApprovalId, a1.ApproverEmployeeNumber, a1.ApproverName, a1.Comment, a1.Department, a1.IsFinalApprover, a1.Position, a1.Sequence, a1.StepType, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE EXISTS (
            SELECT 1
            FROM ApprovalSteps AS a0
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a0.ApprovalId)) && (a0.ApproverEmployeeNumber == @__userId_0))
        ORDER BY a.ApprovalId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Guid? value1;
            string value2;
            DateTime? value3;
            DateTime? value4;
            string value5;
            string value6;
            string value7;
            string value8;
            string value9;
            List<ApprovalStep> namelessParameter{0};
            int? value11;
            string value12;
            string value13;
            string value14;
            value1 = (Guid?)dataReader.GetGuid(0);
            value2 = dataReader.GetString(1);
            value3 = (DateTime?)dataReader.GetDateTime(2);
            value4 = dataReader.IsDBNull(3) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(3);
            value5 = dataReader.GetString(4);
            value6 = dataReader.IsDBNull(5) ? default(string) : dataReader.GetString(5);
            value7 = dataReader.GetString(6);
            value8 = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
            value9 = dataReader.GetString(8);
            namelessParameter{0} = ShaperProcessingExpressionVisitor.InitializeCollection<ApprovalStep, List<ApprovalStep>>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApprovalRequest, List<ApprovalStep>, ApprovalStep> | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalRequest").FindNavigation("Steps").GetCollectionAccessor()]);
            value11 = (int?)dataReader.GetInt32(21);
            value12 = dataReader.IsDBNull(22) ? default(string) : dataReader.GetString(22);
            value13 = dataReader.IsDBNull(23) ? default(string) : dataReader.GetString(23);
            value14 = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
            return resultContext.Values = new object[]
            { 
                (object)value1, 
                value2, 
                (object)value3, 
                (object)value4, 
                value5, 
                value6, 
                value7, 
                value8, 
                value9, 
                namelessParameter{0}, 
                (object)value11, 
                value12, 
                value13, 
                value14 
            };
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateCollection<List<ApprovalStep>, ApprovalStep, ApprovalStep>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(9) ? default(Guid?) : (Guid?)dataReader.GetGuid(9) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApprovalStep entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    ApprovalStep instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(ApprovalStep);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: ApprovalStep.StepId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep").FindPrimaryKey()], 
                        keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetGuid(9) }, 
                        throwOnNullKey: False, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (ApprovalStep)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]: 
                                {
                                    return 
                                    {
                                        ApprovalStep instance;
                                        instance = new ApprovalStep();
                                        instance.<StepId>k__BackingField = dataReader.IsDBNull(9) ? default(Guid) : dataReader.GetGuid(9);
                                        instance.<ActionDate>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                        instance.<ActionStatus>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                        instance.<ApprovalId>k__BackingField = dataReader.IsDBNull(12) ? default(Guid) : dataReader.GetGuid(12);
                                        instance.<ApproverEmployeeNumber>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                        instance.<ApproverName>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        instance.<Comment>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                        instance.<Department>k__BackingField = dataReader.IsDBNull(16) ? default(string) : dataReader.GetString(16);
                                        instance.<IsFinalApprover>k__BackingField = dataReader.IsDBNull(17) ? default(bool) : dataReader.GetBoolean(17);
                                        instance.<Position>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                        instance.<Sequence>k__BackingField = dataReader.IsDBNull(19) ? default(int) : dataReader.GetInt32(19);
                                        instance.<StepType>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApprovalStep)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                return entity;
            });
        return IsTrue(resultCoordinator.ResultReady)
         ? new ApprovalRequestWithCurrentStepDto{ 
            ApprovalId = (Guid)(Guid?)(resultContext.Values[0]), 
            RequestTitle = (string)(resultContext.Values[1]), 
            RequestedAt = (DateTime)(DateTime?)(resultContext.Values[2]), 
            RespondedAt = (DateTime?)(resultContext.Values[3]), 
            ApplicantEmployeeNumber = (string)(resultContext.Values[4]), 
            ApplicantDepartment = (string)(resultContext.Values[5]), 
            ApplicantName = (string)(resultContext.Values[6]), 
            ApplicantPosition = (string)(resultContext.Values[7]), 
            Status = (string)(resultContext.Values[8]), 
            Steps = (List<ApprovalStep>)(resultContext.Values[9]), 
            CurrentStep = (int)(int?)(resultContext.Values[10]), 
            CurrentApproverName = (string)(resultContext.Values[11]), 
            CurrentApproverEmployeeNumber = (string)(resultContext.Values[12]), 
            CurrentActionStatus = (string)(resultContext.Values[13]) 
        }
         : default(ApprovalRequestWithCurrentStepDto);
    }, 
    contextType: ApprovalService.Infrastructure.Persistence.ApprovalDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-15 20:32:22.180 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:32:22.181 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:32:22.181 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:32:22.183 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:22.183 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:32:22.183 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:32:22.184 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-06-15 20:32:22.185 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:32:22.192 +09:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:32:22.213 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.237 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.238 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.238 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.238 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.238 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.239 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.239 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.239 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.239 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:22.239 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:22.239 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 46ms reading results.
2025-06-15 20:32:22.239 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:22.239 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:32:22.241 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:32:22.243 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:32:22.243 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:32:22.243 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:32:22.244 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:32:22.244 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:32:22.296 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API) in 2988.2431ms
2025-06-15 20:32:22.299 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:32:22.299 +09:00 [DBG] Connection id "0HNDC014PLVUV" completed keep alive response.
2025-06-15 20:32:22.301 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:32:22.302 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:32:22.302 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:32:22.303 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - 200 null application/json; charset=utf-8 3087.9447ms
2025-06-15 20:32:48.465 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - null null
2025-06-15 20:32:48.472 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:32:48.472 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)' with route pattern 'api/Approval/my-approvals/{approverId}' is valid for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:32:48.473 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:32:48.499 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:32:48.499 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:32:48.500 +09:00 [INF] Route matched with {action = "GetMyApprovals", controller = "Approval"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyApprovals(System.String) on controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API).
2025-06-15 20:32:48.501 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:32:48.501 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:32:48.501 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:32:48.501 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:32:48.501 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:32:48.501 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:32:48.504 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:32:48.504 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' ...
2025-06-15 20:32:48.505 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' using the name 'approverId' in request data ...
2025-06-15 20:32:48.505 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:32:48.505 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:32:48.505 +09:00 [DBG] Attempting to validate the bound parameter 'approverId' of type 'System.String' ...
2025-06-15 20:32:48.505 +09:00 [DBG] Done attempting to validate the bound parameter 'approverId' of type 'System.String'.
2025-06-15 20:32:50.937 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:32:50.942 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:32:50.942 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:32:50.942 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:32:50.943 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:50.943 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:32:50.943 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:32:50.943 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:32:50.943 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:32:50.944 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:32:50.945 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.945 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.945 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:50.946 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:50.946 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 2ms reading results.
2025-06-15 20:32:50.947 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:50.947 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:32:50.947 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:32:50.947 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:32:50.947 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:32:50.947 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:32:50.947 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:32:50.947 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:32:50.948 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API) in 2446.8954ms
2025-06-15 20:32:50.948 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:32:50.948 +09:00 [DBG] Connection id "0HNDC014PLVUV" completed keep alive response.
2025-06-15 20:32:50.949 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:32:50.949 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:32:50.949 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:32:50.949 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - 200 null application/json; charset=utf-8 2484.0291ms
2025-06-15 20:32:59.251 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20507 - null null
2025-06-15 20:32:59.253 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20507'
2025-06-15 20:32:59.254 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20507'
2025-06-15 20:32:59.254 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:32:59.259 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:32:59.260 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:32:59.267 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 20:32:59.267 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:32:59.267 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:32:59.267 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:32:59.267 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:32:59.267 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:32:59.268 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:32:59.272 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:32:59.272 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 20:32:59.272 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 20:32:59.272 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:32:59.272 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:32:59.273 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 20:32:59.273 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 20:32:59.279 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:32:59.281 +09:00 [DBG] Compiling query expression: 
'DbSet<ApprovalRequest>()
    .Where(r => r.ApplicantEmployeeNumber == __userId_0)
    .OrderByDescending(r => r.RequestedAt)
    .Select(r => new ApprovalRequestWithCurrentStepDto{ 
        ApprovalId = r.ApprovalId, 
        RequestTitle = r.RequestTitle, 
        RequestedAt = r.RequestedAt, 
        RespondedAt = r.RespondedAt, 
        ApplicantEmployeeNumber = r.ApplicantEmployeeNumber, 
        ApplicantName = r.ApplicantName, 
        ApplicantDepartment = r.ApplicantDepartment, 
        ApplicantPosition = r.ApplicantPosition, 
        Steps = r.Steps, 
        Attachments = r.Attachments, 
        Status = r.Status, 
        CurrentStep = r.CurrentStep, 
        CurrentApproverName = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverName)
            .FirstOrDefault(), 
        CurrentApproverEmployeeNumber = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverEmployeeNumber)
            .FirstOrDefault(), 
        CurrentActionStatus = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ActionStatus)
            .FirstOrDefault() 
    }
    )'
2025-06-15 20:32:59.297 +09:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-06-15 20:32:59.306 +09:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApprovalRequestWithCurrentStepDto>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: ApprovalStep.ActionDate (DateTime?), 9], [Property: ApprovalStep.ActionStatus (string), 10], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 11], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 12], [Property: ApprovalStep.ApproverName (string), 13], [Property: ApprovalStep.Comment (string), 14], [Property: ApprovalStep.Department (string), 15], [Property: ApprovalStep.IsFinalApprover (bool) Required, 16], [Property: ApprovalStep.Position (string), 17], [Property: ApprovalStep.Sequence (int) Required, 18], [Property: ApprovalStep.StepType (string), 19] }
            9 -> 8
            10 -> Dictionary<IProperty, int> { [Property: ApprovalAttachment.AttachmentId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: ApprovalAttachment.ApprovalId (Guid) Required FK Index, 21], [Property: ApprovalAttachment.FileName (string) Required, 22], [Property: ApprovalAttachment.FilePath (string) Required, 23], [Property: ApprovalAttachment.FileSize (long?), 24], [Property: ApprovalAttachment.FileType (string), 25], [Property: ApprovalAttachment.UploadedAt (DateTime) Required, 26], [Property: ApprovalAttachment.UploadedByEmployeeNumber (string) Required, 27] }
            11 -> 20
            12 -> 28
            13 -> 29
            14 -> 30
            15 -> 31
            16 -> 32
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantName, a.ApplicantDepartment, a.ApplicantPosition, a0.StepId, a0.ActionDate, a0.ActionStatus, a0.ApprovalId, a0.ApproverEmployeeNumber, a0.ApproverName, a0.Comment, a0.Department, a0.IsFinalApprover, a0.Position, a0.Sequence, a0.StepType, a1.AttachmentId, a1.ApprovalId, a1.FileName, a1.FilePath, a1.FileSize, a1.FileType, a1.UploadedAt, a1.UploadedByEmployeeNumber, a.Status, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a0 ON a.ApprovalId == a0.ApprovalId
        LEFT JOIN ApprovalAttachments AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE a.ApplicantEmployeeNumber == @__userId_0
        ORDER BY a.RequestedAt DESC, a.ApprovalId ASC, a0.StepId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: ApprovalStep.ActionDate (DateTime?), 9], [Property: ApprovalStep.ActionStatus (string), 10], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 11], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 12], [Property: ApprovalStep.ApproverName (string), 13], [Property: ApprovalStep.Comment (string), 14], [Property: ApprovalStep.Department (string), 15], [Property: ApprovalStep.IsFinalApprover (bool) Required, 16], [Property: ApprovalStep.Position (string), 17], [Property: ApprovalStep.Sequence (int) Required, 18], [Property: ApprovalStep.StepType (string), 19] }
            9 -> 8
            10 -> Dictionary<IProperty, int> { [Property: ApprovalAttachment.AttachmentId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: ApprovalAttachment.ApprovalId (Guid) Required FK Index, 21], [Property: ApprovalAttachment.FileName (string) Required, 22], [Property: ApprovalAttachment.FilePath (string) Required, 23], [Property: ApprovalAttachment.FileSize (long?), 24], [Property: ApprovalAttachment.FileType (string), 25], [Property: ApprovalAttachment.UploadedAt (DateTime) Required, 26], [Property: ApprovalAttachment.UploadedByEmployeeNumber (string) Required, 27] }
            11 -> 20
            12 -> 28
            13 -> 29
            14 -> 30
            15 -> 31
            16 -> 32
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantName, a.ApplicantDepartment, a.ApplicantPosition, a0.StepId, a0.ActionDate, a0.ActionStatus, a0.ApprovalId, a0.ApproverEmployeeNumber, a0.ApproverName, a0.Comment, a0.Department, a0.IsFinalApprover, a0.Position, a0.Sequence, a0.StepType, a1.AttachmentId, a1.ApprovalId, a1.FileName, a1.FilePath, a1.FileSize, a1.FileType, a1.UploadedAt, a1.UploadedByEmployeeNumber, a.Status, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a0 ON a.ApprovalId == a0.ApprovalId
        LEFT JOIN ApprovalAttachments AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE a.ApplicantEmployeeNumber == @__userId_0
        ORDER BY a.RequestedAt DESC, a.ApprovalId ASC, a0.StepId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Guid? value1;
            string value2;
            DateTime? value3;
            DateTime? value4;
            string value5;
            string value6;
            string value7;
            string value8;
            List<ApprovalStep> namelessParameter{0};
            List<ApprovalAttachment> namelessParameter{1};
            string value11;
            int? value12;
            string value13;
            string value14;
            string value15;
            value1 = (Guid?)dataReader.GetGuid(0);
            value2 = dataReader.GetString(1);
            value3 = (DateTime?)dataReader.GetDateTime(2);
            value4 = dataReader.IsDBNull(3) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(3);
            value5 = dataReader.GetString(4);
            value6 = dataReader.GetString(5);
            value7 = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
            value8 = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
            namelessParameter{0} = ShaperProcessingExpressionVisitor.InitializeCollection<ApprovalStep, List<ApprovalStep>>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApprovalRequest, List<ApprovalStep>, ApprovalStep> | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalRequest").FindNavigation("Steps").GetCollectionAccessor()]);
            namelessParameter{1} = ShaperProcessingExpressionVisitor.InitializeCollection<ApprovalAttachment, List<ApprovalAttachment>>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(Guid?)dataReader.GetGuid(0), 
                    (object)dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8) 
                }], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApprovalRequest, List<ApprovalAttachment>, ApprovalAttachment> | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalRequest").FindNavigation("Attachments").GetCollectionAccessor()]);
            value11 = dataReader.GetString(28);
            value12 = (int?)dataReader.GetInt32(29);
            value13 = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
            value14 = dataReader.IsDBNull(31) ? default(string) : dataReader.GetString(31);
            value15 = dataReader.IsDBNull(32) ? default(string) : dataReader.GetString(32);
            return resultContext.Values = new object[]
            { 
                (object)value1, 
                value2, 
                (object)value3, 
                (object)value4, 
                value5, 
                value6, 
                value7, 
                value8, 
                namelessParameter{0}, 
                namelessParameter{1}, 
                value11, 
                (object)value12, 
                value13, 
                value14, 
                value15 
            };
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateCollection<List<ApprovalStep>, ApprovalStep, ApprovalStep>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApprovalStep entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    ApprovalStep instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(ApprovalStep);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: ApprovalStep.StepId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep").FindPrimaryKey()], 
                        keyValues: new object[]{ dataReader.IsDBNull(8) ? default(object) : (object)dataReader.GetGuid(8) }, 
                        throwOnNullKey: False, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (ApprovalStep)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]: 
                                {
                                    return 
                                    {
                                        ApprovalStep instance;
                                        instance = new ApprovalStep();
                                        instance.<StepId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ActionDate>k__BackingField = dataReader.IsDBNull(9) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(9);
                                        instance.<ActionStatus>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<ApprovalId>k__BackingField = dataReader.IsDBNull(11) ? default(Guid) : dataReader.GetGuid(11);
                                        instance.<ApproverEmployeeNumber>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        instance.<ApproverName>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                        instance.<Comment>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        instance.<Department>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                        instance.<IsFinalApprover>k__BackingField = dataReader.IsDBNull(16) ? default(bool) : dataReader.GetBoolean(16);
                                        instance.<Position>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                        instance.<Sequence>k__BackingField = dataReader.IsDBNull(18) ? default(int) : dataReader.GetInt32(18);
                                        instance.<StepType>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApprovalStep)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                return entity;
            });
        ShaperProcessingExpressionVisitor.PopulateCollection<List<ApprovalAttachment>, ApprovalAttachment, ApprovalAttachment>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(Guid?)dataReader.GetGuid(0), 
                (object)dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(20) ? default(Guid?) : (Guid?)dataReader.GetGuid(20) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right, 
                (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApprovalAttachment entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ApprovalAttachment instance2;
                    InternalEntityEntry entry2;
                    bool hasNullKey2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ApprovalAttachment);
                    entry2 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: ApprovalAttachment.AttachmentId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment").FindPrimaryKey()], 
                        keyValues: new object[]{ dataReader.IsDBNull(20) ? default(object) : (object)dataReader.GetGuid(20) }, 
                        throwOnNullKey: False, 
                        hasNullKey: hasNullKey2);
                    !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                    {
                        entityType2 = entry2.EntityType;
                        return instance2 = (ApprovalAttachment)entry2.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ApprovalAttachment | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ApprovalAttachment | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment")]: 
                                {
                                    return 
                                    {
                                        ApprovalAttachment instance;
                                        instance = new ApprovalAttachment();
                                        instance.<AttachmentId>k__BackingField = dataReader.IsDBNull(20) ? default(Guid) : dataReader.GetGuid(20);
                                        instance.<ApprovalId>k__BackingField = dataReader.IsDBNull(21) ? default(Guid) : dataReader.GetGuid(21);
                                        instance.<FileName>k__BackingField = dataReader.IsDBNull(22) ? default(string) : dataReader.GetString(22);
                                        instance.<FilePath>k__BackingField = dataReader.IsDBNull(23) ? default(string) : dataReader.GetString(23);
                                        instance.<FileSize>k__BackingField = dataReader.IsDBNull(24) ? default(long?) : (long?)dataReader.GetInt64(24);
                                        instance.<FileType>k__BackingField = dataReader.IsDBNull(25) ? default(string) : dataReader.GetString(25);
                                        instance.<UploadedAt>k__BackingField = dataReader.IsDBNull(26) ? default(DateTime) : dataReader.GetDateTime(26);
                                        instance.<UploadedByEmployeeNumber>k__BackingField = dataReader.IsDBNull(27) ? default(string) : dataReader.GetString(27);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApprovalAttachment | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApprovalAttachment)
                        }
                        ;
                        entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType2, 
                            entity: instance2, 
                            snapshot: shadowSnapshot2);
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            });
        return IsTrue(resultCoordinator.ResultReady)
         ? new ApprovalRequestWithCurrentStepDto{ 
            ApprovalId = (Guid)(Guid?)(resultContext.Values[0]), 
            RequestTitle = (string)(resultContext.Values[1]), 
            RequestedAt = (DateTime)(DateTime?)(resultContext.Values[2]), 
            RespondedAt = (DateTime?)(resultContext.Values[3]), 
            ApplicantEmployeeNumber = (string)(resultContext.Values[4]), 
            ApplicantName = (string)(resultContext.Values[5]), 
            ApplicantDepartment = (string)(resultContext.Values[6]), 
            ApplicantPosition = (string)(resultContext.Values[7]), 
            Steps = (List<ApprovalStep>)(resultContext.Values[8]), 
            Attachments = (List<ApprovalAttachment>)(resultContext.Values[9]), 
            Status = (string)(resultContext.Values[10]), 
            CurrentStep = (int)(int?)(resultContext.Values[11]), 
            CurrentApproverName = (string)(resultContext.Values[12]), 
            CurrentApproverEmployeeNumber = (string)(resultContext.Values[13]), 
            CurrentActionStatus = (string)(resultContext.Values[14]) 
        }
         : default(ApprovalRequestWithCurrentStepDto);
    }, 
    contextType: ApprovalService.Infrastructure.Persistence.ApprovalDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-15 20:32:59.313 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:32:59.313 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:32:59.313 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:32:59.314 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:59.314 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:32:59.314 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:32:59.314 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:32:59.314 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:32:59.315 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:32:59.317 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.318 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.318 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.318 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.318 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.318 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.319 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.319 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:32:59.319 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:59.319 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 3ms reading results.
2025-06-15 20:32:59.319 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:32:59.319 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:32:59.319 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:32:59.319 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:32:59.319 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:32:59.319 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:32:59.319 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:32:59.319 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:32:59.322 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 54.3102ms
2025-06-15 20:32:59.322 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:32:59.322 +09:00 [DBG] Connection id "0HNDC014PLVUV" completed keep alive response.
2025-06-15 20:32:59.322 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:32:59.323 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:32:59.323 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:32:59.323 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20507 - 200 null application/json; charset=utf-8 72.5512ms
2025-06-15 20:33:02.435 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - null null
2025-06-15 20:33:02.435 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:33:02.435 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)' with route pattern 'api/Approval/my-approvals/{approverId}' is valid for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:33:02.436 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:33:02.436 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:33:02.436 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:33:02.436 +09:00 [INF] Route matched with {action = "GetMyApprovals", controller = "Approval"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyApprovals(System.String) on controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API).
2025-06-15 20:33:02.436 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:33:02.436 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:33:02.436 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:33:02.436 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:33:02.436 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:33:02.436 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:33:02.443 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:33:02.443 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' ...
2025-06-15 20:33:02.444 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' using the name 'approverId' in request data ...
2025-06-15 20:33:02.445 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:33:02.445 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:33:02.445 +09:00 [DBG] Attempting to validate the bound parameter 'approverId' of type 'System.String' ...
2025-06-15 20:33:02.445 +09:00 [DBG] Done attempting to validate the bound parameter 'approverId' of type 'System.String'.
2025-06-15 20:33:02.447 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:33:02.448 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:33:02.448 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:33:02.448 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:33:02.448 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:33:02.448 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:33:02.448 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:33:02.448 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:33:02.449 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:33:02.450 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:33:02.451 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.452 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.452 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.453 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.453 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.453 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.453 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.453 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.453 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.454 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:33:02.454 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:33:02.454 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 3ms reading results.
2025-06-15 20:33:02.454 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:33:02.454 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:33:02.455 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:33:02.455 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:33:02.455 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:33:02.455 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:33:02.455 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:33:02.455 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:33:02.456 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API) in 19.4216ms
2025-06-15 20:33:02.456 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:33:02.456 +09:00 [DBG] Connection id "0HNDC014PLVUV" completed keep alive response.
2025-06-15 20:33:02.456 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:33:02.456 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:33:02.456 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:33:02.456 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - 200 null application/json; charset=utf-8 21.1584ms
2025-06-15 20:34:04.129 +09:00 [DBG] Connection id "0HNDC014PLVUV" received FIN.
2025-06-15 20:34:04.179 +09:00 [DBG] Connection id "0HNDC014PLVUV" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-15 20:34:04.179 +09:00 [DBG] Connection id "0HNDC014PLVUV" disconnecting.
2025-06-15 20:34:04.181 +09:00 [DBG] Connection id "0HNDC014PLVUV" stopped.
2025-06-15 20:34:58.480 +09:00 [DBG] Connection id "0HNDC014PLVV0" accepted.
2025-06-15 20:34:58.508 +09:00 [DBG] Connection id "0HNDC014PLVV0" started.
2025-06-15 20:34:58.534 +09:00 [DBG] Connection 0HNDC014PLVV0 established using the following protocol: "Tls12"
2025-06-15 20:34:58.543 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - null null
2025-06-15 20:34:58.544 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:34:58.544 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)' with route pattern 'api/Approval/my-approvals/{approverId}' is valid for the request path '/api/approval/my-approvals/EC20507'
2025-06-15 20:34:58.544 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:34:58.545 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:34:58.545 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:34:58.546 +09:00 [INF] Route matched with {action = "GetMyApprovals", controller = "Approval"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyApprovals(System.String) on controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API).
2025-06-15 20:34:58.546 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:34:58.546 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:34:58.546 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:34:58.546 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:34:58.546 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:34:58.546 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:34:58.547 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:34:58.548 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' ...
2025-06-15 20:34:58.548 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' using the name 'approverId' in request data ...
2025-06-15 20:34:58.548 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:34:58.548 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:34:58.548 +09:00 [DBG] Attempting to validate the bound parameter 'approverId' of type 'System.String' ...
2025-06-15 20:34:58.548 +09:00 [DBG] Done attempting to validate the bound parameter 'approverId' of type 'System.String'.
2025-06-15 20:34:58.551 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:34:58.554 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:34:58.554 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:34:58.554 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:34:58.555 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:34:58.555 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:34:58.555 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:34:58.555 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:34:58.555 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:34:58.556 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:34:58.557 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.558 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.558 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.559 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.559 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.559 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.560 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.560 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.560 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.560 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:34:58.561 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:34:58.561 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 4ms reading results.
2025-06-15 20:34:58.561 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:34:58.561 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:34:58.562 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:34:58.562 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:34:58.562 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:34:58.562 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:34:58.562 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:34:58.562 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:34:58.564 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API) in 17.2444ms
2025-06-15 20:34:58.564 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:34:58.564 +09:00 [DBG] Connection id "0HNDC014PLVV0" completed keep alive response.
2025-06-15 20:34:58.564 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:34:58.564 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:34:58.564 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:34:58.565 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20507 - 200 null application/json; charset=utf-8 21.2925ms
2025-06-15 20:36:13.464 +09:00 [DBG] Connection id "0HNDC014PLVV0" received FIN.
2025-06-15 20:36:13.500 +09:00 [DBG] Connection id "0HNDC014PLVV0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-15 20:36:13.502 +09:00 [DBG] Connection id "0HNDC014PLVV0" disconnecting.
2025-06-15 20:36:13.507 +09:00 [DBG] Connection id "0HNDC014PLVV0" stopped.
2025-06-15 20:39:06.639 +09:00 [DBG] Connection id "0HNDC014PLVV1" accepted.
2025-06-15 20:39:06.641 +09:00 [DBG] Connection id "0HNDC014PLVV1" started.
2025-06-15 20:39:06.671 +09:00 [DBG] Connection 0HNDC014PLVV1 established using the following protocol: "Tls12"
2025-06-15 20:39:06.712 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20507 - null null
2025-06-15 20:39:06.714 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20507'
2025-06-15 20:39:06.715 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20507'
2025-06-15 20:39:06.715 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:39:06.716 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:39:06.716 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:39:06.717 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 20:39:06.717 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:39:06.717 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:39:06.717 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:39:06.718 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:39:06.718 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:39:06.718 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:39:06.719 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:39:06.720 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 20:39:06.720 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 20:39:06.720 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:39:06.720 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:39:06.720 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 20:39:06.720 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 20:39:06.723 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:39:06.725 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:39:06.725 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:39:06.725 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:39:06.726 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:39:06.726 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:39:06.726 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:39:06.727 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:39:06.728 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:39:06.730 +09:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.731 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.732 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:06.732 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:39:06.732 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 1ms reading results.
2025-06-15 20:39:06.732 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:39:06.732 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:39:06.732 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:39:06.732 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:39:06.732 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:39:06.732 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:39:06.732 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:39:06.732 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:39:06.736 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 18.2136ms
2025-06-15 20:39:06.736 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:39:06.737 +09:00 [DBG] Connection id "0HNDC014PLVV1" completed keep alive response.
2025-06-15 20:39:06.737 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:39:06.737 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:39:06.737 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:39:06.737 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20507 - 200 null application/json; charset=utf-8 25.7377ms
2025-06-15 20:39:12.250 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - null null
2025-06-15 20:39:12.250 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:39:12.250 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:39:12.250 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:39:12.251 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:39:12.251 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:39:12.251 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 20:39:12.251 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:39:12.252 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:39:12.252 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:39:12.252 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:39:12.254 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:39:12.254 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:39:12.256 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:39:12.256 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 20:39:12.256 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 20:39:12.256 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:39:12.256 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:39:12.257 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 20:39:12.257 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 20:39:12.258 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:39:12.259 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:39:12.259 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:39:12.259 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:39:12.260 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:39:12.260 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:39:12.260 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:39:12.260 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:39:12.261 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:39:12.262 +09:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:39:12.263 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.267 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.282 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.282 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.282 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.282 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.282 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.283 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.283 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.283 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:39:12.283 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:39:12.283 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 20ms reading results.
2025-06-15 20:39:12.283 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:39:12.283 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:39:12.284 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:39:12.284 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:39:12.284 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:39:12.284 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:39:12.284 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:39:12.284 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:39:12.291 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 36.8373ms
2025-06-15 20:39:12.291 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:39:12.291 +09:00 [DBG] Connection id "0HNDC014PLVV1" completed keep alive response.
2025-06-15 20:39:12.291 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:39:12.291 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:39:12.291 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:39:12.292 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - 200 null application/json; charset=utf-8 41.8649ms
2025-06-15 20:40:21.574 +09:00 [DBG] Connection id "0HNDC014PLVV1" received FIN.
2025-06-15 20:40:21.620 +09:00 [DBG] Connection id "0HNDC014PLVV1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-15 20:40:21.622 +09:00 [DBG] Connection id "0HNDC014PLVV1" disconnecting.
2025-06-15 20:40:21.651 +09:00 [DBG] Connection id "0HNDC014PLVV1" stopped.
2025-06-15 20:42:17.442 +09:00 [INF] Starting Approval Service API
2025-06-15 20:42:17.650 +09:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-15 20:42:17.748 +09:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-06-15 20:42:18.035 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:42:18.040 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:18.045 +09:00 [DBG] Created DbConnection. (4ms).
2025-06-15 20:42:18.048 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.055 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.057 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.059 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:18.061 +09:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-06-15 20:42:18.062 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:18.062 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:42:18.064 +09:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-06-15 20:42:18.065 +09:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-06-15 20:42:18.065 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.065 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.068 +09:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:42:18.082 +09:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:42:18.083 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.085 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (1ms).
2025-06-15 20:42:18.087 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:18.087 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:42:18.087 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.087 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.088 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.088 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:18.088 +09:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-06-15 20:42:18.088 +09:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-06-15 20:42:18.088 +09:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-06-15 20:42:18.088 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.088 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.088 +09:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:42:18.088 +09:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "type" = 'table' AND "rootpage" IS NOT NULL;
2025-06-15 20:42:18.088 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.089 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:18.112 +09:00 [DBG] Compiling query expression: 
'DbSet<ApprovalRequest>()
    .Any()'
2025-06-15 20:42:18.209 +09:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM ApprovalRequests AS a)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM ApprovalRequests AS a), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: ApprovalService.Infrastructure.Persistence.ApprovalDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-15 20:42:18.327 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.328 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.328 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:42:18.328 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:18.328 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:18.330 +09:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ApprovalRequests" AS "a")
2025-06-15 20:42:18.332 +09:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ApprovalRequests" AS "a")
2025-06-15 20:42:18.335 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.336 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 3ms reading results.
2025-06-15 20:42:18.337 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:18.338 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:18.338 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:42:18.339 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:18.339 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:18.340 +09:00 [DBG] Hosting starting
2025-06-15 20:42:18.411 +09:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-06-15 20:42:18.412 +09:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-15 20:42:18.700 +09:00 [INF] Now listening on: https://localhost:5001
2025-06-15 20:42:18.700 +09:00 [INF] Now listening on: http://localhost:5229
2025-06-15 20:42:18.700 +09:00 [DBG] Loaded hosting startup assembly ApprovalService.API
2025-06-15 20:42:18.701 +09:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-15 20:42:18.701 +09:00 [INF] Hosting environment: Development
2025-06-15 20:42:18.701 +09:00 [INF] Content root path: /Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API
2025-06-15 20:42:18.701 +09:00 [DBG] Hosting started
2025-06-15 20:42:29.314 +09:00 [DBG] Connection id "0HNDC06QKPPHF" accepted.
2025-06-15 20:42:29.315 +09:00 [DBG] Connection id "0HNDC06QKPPHF" started.
2025-06-15 20:42:29.347 +09:00 [DBG] Connection 0HNDC06QKPPHF established using the following protocol: "Tls12"
2025-06-15 20:42:29.381 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - null null
2025-06-15 20:42:29.402 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:42:29.404 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:42:29.404 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:29.417 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:42:29.418 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:29.429 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 20:42:29.430 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:42:29.430 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:42:29.430 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:42:29.430 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:42:29.431 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:42:29.431 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:42:29.432 +09:00 [INF] Initializing ApprovalRequestController
2025-06-15 20:42:29.432 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:42:29.437 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 20:42:29.439 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 20:42:29.439 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:42:29.439 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:42:29.439 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 20:42:29.441 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 20:42:29.450 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:42:29.460 +09:00 [DBG] Compiling query expression: 
'DbSet<ApprovalRequest>()
    .Where(r => r.ApplicantEmployeeNumber == __userId_0)
    .OrderByDescending(r => r.RequestedAt)
    .Select(r => new ApprovalRequestWithCurrentStepDto{ 
        ApprovalId = r.ApprovalId, 
        RequestTitle = r.RequestTitle, 
        RequestedAt = r.RequestedAt, 
        RespondedAt = r.RespondedAt, 
        ApplicantEmployeeNumber = r.ApplicantEmployeeNumber, 
        ApplicantName = r.ApplicantName, 
        ApplicantDepartment = r.ApplicantDepartment, 
        ApplicantPosition = r.ApplicantPosition, 
        Steps = r.Steps, 
        Attachments = r.Attachments, 
        Status = r.Status, 
        CurrentStep = r.CurrentStep, 
        CurrentApproverName = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverName)
            .FirstOrDefault(), 
        CurrentApproverEmployeeNumber = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverEmployeeNumber)
            .FirstOrDefault(), 
        CurrentActionStatus = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ActionStatus)
            .FirstOrDefault() 
    }
    )'
2025-06-15 20:42:29.522 +09:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-06-15 20:42:29.533 +09:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApprovalRequestWithCurrentStepDto>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: ApprovalStep.ActionDate (DateTime?), 9], [Property: ApprovalStep.ActionStatus (string), 10], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 11], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 12], [Property: ApprovalStep.ApproverName (string), 13], [Property: ApprovalStep.Comment (string), 14], [Property: ApprovalStep.Department (string), 15], [Property: ApprovalStep.IsFinalApprover (bool) Required, 16], [Property: ApprovalStep.Position (string), 17], [Property: ApprovalStep.Sequence (int) Required, 18], [Property: ApprovalStep.StepType (string), 19] }
            9 -> 8
            10 -> Dictionary<IProperty, int> { [Property: ApprovalAttachment.AttachmentId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: ApprovalAttachment.ApprovalId (Guid) Required FK Index, 21], [Property: ApprovalAttachment.FileName (string) Required, 22], [Property: ApprovalAttachment.FilePath (string) Required, 23], [Property: ApprovalAttachment.FileSize (long?), 24], [Property: ApprovalAttachment.FileType (string), 25], [Property: ApprovalAttachment.UploadedAt (DateTime) Required, 26], [Property: ApprovalAttachment.UploadedByEmployeeNumber (string) Required, 27] }
            11 -> 20
            12 -> 28
            13 -> 29
            14 -> 30
            15 -> 31
            16 -> 32
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantName, a.ApplicantDepartment, a.ApplicantPosition, a0.StepId, a0.ActionDate, a0.ActionStatus, a0.ApprovalId, a0.ApproverEmployeeNumber, a0.ApproverName, a0.Comment, a0.Department, a0.IsFinalApprover, a0.Position, a0.Sequence, a0.StepType, a1.AttachmentId, a1.ApprovalId, a1.FileName, a1.FilePath, a1.FileSize, a1.FileType, a1.UploadedAt, a1.UploadedByEmployeeNumber, a.Status, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a0 ON a.ApprovalId == a0.ApprovalId
        LEFT JOIN ApprovalAttachments AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE a.ApplicantEmployeeNumber == @__userId_0
        ORDER BY a.RequestedAt DESC, a.ApprovalId ASC, a0.StepId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: ApprovalStep.ActionDate (DateTime?), 9], [Property: ApprovalStep.ActionStatus (string), 10], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 11], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 12], [Property: ApprovalStep.ApproverName (string), 13], [Property: ApprovalStep.Comment (string), 14], [Property: ApprovalStep.Department (string), 15], [Property: ApprovalStep.IsFinalApprover (bool) Required, 16], [Property: ApprovalStep.Position (string), 17], [Property: ApprovalStep.Sequence (int) Required, 18], [Property: ApprovalStep.StepType (string), 19] }
            9 -> 8
            10 -> Dictionary<IProperty, int> { [Property: ApprovalAttachment.AttachmentId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 20], [Property: ApprovalAttachment.ApprovalId (Guid) Required FK Index, 21], [Property: ApprovalAttachment.FileName (string) Required, 22], [Property: ApprovalAttachment.FilePath (string) Required, 23], [Property: ApprovalAttachment.FileSize (long?), 24], [Property: ApprovalAttachment.FileType (string), 25], [Property: ApprovalAttachment.UploadedAt (DateTime) Required, 26], [Property: ApprovalAttachment.UploadedByEmployeeNumber (string) Required, 27] }
            11 -> 20
            12 -> 28
            13 -> 29
            14 -> 30
            15 -> 31
            16 -> 32
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantName, a.ApplicantDepartment, a.ApplicantPosition, a0.StepId, a0.ActionDate, a0.ActionStatus, a0.ApprovalId, a0.ApproverEmployeeNumber, a0.ApproverName, a0.Comment, a0.Department, a0.IsFinalApprover, a0.Position, a0.Sequence, a0.StepType, a1.AttachmentId, a1.ApprovalId, a1.FileName, a1.FilePath, a1.FileSize, a1.FileType, a1.UploadedAt, a1.UploadedByEmployeeNumber, a.Status, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a0 ON a.ApprovalId == a0.ApprovalId
        LEFT JOIN ApprovalAttachments AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE a.ApplicantEmployeeNumber == @__userId_0
        ORDER BY a.RequestedAt DESC, a.ApprovalId ASC, a0.StepId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Guid? value1;
            string value2;
            DateTime? value3;
            DateTime? value4;
            string value5;
            string value6;
            string value7;
            string value8;
            List<ApprovalStep> namelessParameter{0};
            List<ApprovalAttachment> namelessParameter{1};
            string value11;
            int? value12;
            string value13;
            string value14;
            string value15;
            value1 = (Guid?)dataReader.GetGuid(0);
            value2 = dataReader.GetString(1);
            value3 = (DateTime?)dataReader.GetDateTime(2);
            value4 = dataReader.IsDBNull(3) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(3);
            value5 = dataReader.GetString(4);
            value6 = dataReader.GetString(5);
            value7 = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
            value8 = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
            namelessParameter{0} = ShaperProcessingExpressionVisitor.InitializeCollection<ApprovalStep, List<ApprovalStep>>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApprovalRequest, List<ApprovalStep>, ApprovalStep> | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalRequest").FindNavigation("Steps").GetCollectionAccessor()]);
            namelessParameter{1} = ShaperProcessingExpressionVisitor.InitializeCollection<ApprovalAttachment, List<ApprovalAttachment>>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(Guid?)dataReader.GetGuid(0), 
                    (object)dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8) 
                }], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApprovalRequest, List<ApprovalAttachment>, ApprovalAttachment> | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalRequest").FindNavigation("Attachments").GetCollectionAccessor()]);
            value11 = dataReader.GetString(28);
            value12 = (int?)dataReader.GetInt32(29);
            value13 = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
            value14 = dataReader.IsDBNull(31) ? default(string) : dataReader.GetString(31);
            value15 = dataReader.IsDBNull(32) ? default(string) : dataReader.GetString(32);
            return resultContext.Values = new object[]
            { 
                (object)value1, 
                value2, 
                (object)value3, 
                (object)value4, 
                value5, 
                value6, 
                value7, 
                value8, 
                namelessParameter{0}, 
                namelessParameter{1}, 
                value11, 
                (object)value12, 
                value13, 
                value14, 
                value15 
            };
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateCollection<List<ApprovalStep>, ApprovalStep, ApprovalStep>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApprovalStep entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    ApprovalStep instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(ApprovalStep);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: ApprovalStep.StepId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep").FindPrimaryKey()], 
                        keyValues: new object[]{ dataReader.IsDBNull(8) ? default(object) : (object)dataReader.GetGuid(8) }, 
                        throwOnNullKey: False, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (ApprovalStep)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]: 
                                {
                                    return 
                                    {
                                        ApprovalStep instance;
                                        instance = new ApprovalStep();
                                        instance.<StepId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ActionDate>k__BackingField = dataReader.IsDBNull(9) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(9);
                                        instance.<ActionStatus>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<ApprovalId>k__BackingField = dataReader.IsDBNull(11) ? default(Guid) : dataReader.GetGuid(11);
                                        instance.<ApproverEmployeeNumber>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        instance.<ApproverName>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                        instance.<Comment>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        instance.<Department>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                        instance.<IsFinalApprover>k__BackingField = dataReader.IsDBNull(16) ? default(bool) : dataReader.GetBoolean(16);
                                        instance.<Position>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                        instance.<Sequence>k__BackingField = dataReader.IsDBNull(18) ? default(int) : dataReader.GetInt32(18);
                                        instance.<StepType>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApprovalStep)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                return entity;
            });
        ShaperProcessingExpressionVisitor.PopulateCollection<List<ApprovalAttachment>, ApprovalAttachment, ApprovalAttachment>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(Guid?)dataReader.GetGuid(0), 
                (object)dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(20) ? default(Guid?) : (Guid?)dataReader.GetGuid(20) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right, 
                (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApprovalAttachment entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ApprovalAttachment instance2;
                    InternalEntityEntry entry2;
                    bool hasNullKey2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ApprovalAttachment);
                    entry2 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: ApprovalAttachment.AttachmentId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment").FindPrimaryKey()], 
                        keyValues: new object[]{ dataReader.IsDBNull(20) ? default(object) : (object)dataReader.GetGuid(20) }, 
                        throwOnNullKey: False, 
                        hasNullKey: hasNullKey2);
                    !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                    {
                        entityType2 = entry2.EntityType;
                        return instance2 = (ApprovalAttachment)entry2.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ApprovalAttachment | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ApprovalAttachment | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment")]: 
                                {
                                    return 
                                    {
                                        ApprovalAttachment instance;
                                        instance = new ApprovalAttachment();
                                        instance.<AttachmentId>k__BackingField = dataReader.IsDBNull(20) ? default(Guid) : dataReader.GetGuid(20);
                                        instance.<ApprovalId>k__BackingField = dataReader.IsDBNull(21) ? default(Guid) : dataReader.GetGuid(21);
                                        instance.<FileName>k__BackingField = dataReader.IsDBNull(22) ? default(string) : dataReader.GetString(22);
                                        instance.<FilePath>k__BackingField = dataReader.IsDBNull(23) ? default(string) : dataReader.GetString(23);
                                        instance.<FileSize>k__BackingField = dataReader.IsDBNull(24) ? default(long?) : (long?)dataReader.GetInt64(24);
                                        instance.<FileType>k__BackingField = dataReader.IsDBNull(25) ? default(string) : dataReader.GetString(25);
                                        instance.<UploadedAt>k__BackingField = dataReader.IsDBNull(26) ? default(DateTime) : dataReader.GetDateTime(26);
                                        instance.<UploadedByEmployeeNumber>k__BackingField = dataReader.IsDBNull(27) ? default(string) : dataReader.GetString(27);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApprovalAttachment | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalAttachment")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApprovalAttachment)
                        }
                        ;
                        entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType2, 
                            entity: instance2, 
                            snapshot: shadowSnapshot2);
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            });
        return IsTrue(resultCoordinator.ResultReady)
         ? new ApprovalRequestWithCurrentStepDto{ 
            ApprovalId = (Guid)(Guid?)(resultContext.Values[0]), 
            RequestTitle = (string)(resultContext.Values[1]), 
            RequestedAt = (DateTime)(DateTime?)(resultContext.Values[2]), 
            RespondedAt = (DateTime?)(resultContext.Values[3]), 
            ApplicantEmployeeNumber = (string)(resultContext.Values[4]), 
            ApplicantName = (string)(resultContext.Values[5]), 
            ApplicantDepartment = (string)(resultContext.Values[6]), 
            ApplicantPosition = (string)(resultContext.Values[7]), 
            Steps = (List<ApprovalStep>)(resultContext.Values[8]), 
            Attachments = (List<ApprovalAttachment>)(resultContext.Values[9]), 
            Status = (string)(resultContext.Values[10]), 
            CurrentStep = (int)(int?)(resultContext.Values[11]), 
            CurrentApproverName = (string)(resultContext.Values[12]), 
            CurrentApproverEmployeeNumber = (string)(resultContext.Values[13]), 
            CurrentActionStatus = (string)(resultContext.Values[14]) 
        }
         : default(ApprovalRequestWithCurrentStepDto);
    }, 
    contextType: ApprovalService.Infrastructure.Persistence.ApprovalDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-15 20:42:29.569 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:29.569 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:42:29.570 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:29.570 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:29.570 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:42:29.570 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:29.572 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-06-15 20:42:29.573 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:42:29.578 +09:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:42:29.595 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.611 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.619 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.619 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.620 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.620 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.620 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.620 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.620 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.621 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:29.621 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:29.621 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 42ms reading results.
2025-06-15 20:42:29.621 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:29.621 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:29.623 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:42:29.626 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:42:29.627 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:42:29.627 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:42:29.628 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:42:29.629 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:42:29.680 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 248.3348ms
2025-06-15 20:42:29.682 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:29.683 +09:00 [DBG] Connection id "0HNDC06QKPPHF" completed keep alive response.
2025-06-15 20:42:29.684 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:42:29.687 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:29.687 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:29.688 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - 200 null application/json; charset=utf-8 308.0111ms
2025-06-15 20:42:30.864 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20505 - null null
2025-06-15 20:42:30.865 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approval/my-approvals/EC20505'
2025-06-15 20:42:30.865 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)' with route pattern 'api/Approval/my-approvals/{approverId}' is valid for the request path '/api/approval/my-approvals/EC20505'
2025-06-15 20:42:30.866 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:42:30.867 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:42:30.867 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:42:30.871 +09:00 [INF] Route matched with {action = "GetMyApprovals", controller = "Approval"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyApprovals(System.String) on controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API).
2025-06-15 20:42:30.871 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:42:30.871 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:42:30.871 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:42:30.871 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:42:30.871 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:42:30.871 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:42:30.873 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalController (ApprovalService.API)
2025-06-15 20:42:30.873 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' ...
2025-06-15 20:42:30.873 +09:00 [DBG] Attempting to bind parameter 'approverId' of type 'System.String' using the name 'approverId' in request data ...
2025-06-15 20:42:30.874 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:42:30.874 +09:00 [DBG] Done attempting to bind parameter 'approverId' of type 'System.String'.
2025-06-15 20:42:30.874 +09:00 [DBG] Attempting to validate the bound parameter 'approverId' of type 'System.String' ...
2025-06-15 20:42:30.874 +09:00 [DBG] Done attempting to validate the bound parameter 'approverId' of type 'System.String'.
2025-06-15 20:42:30.901 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:42:30.904 +09:00 [DBG] Compiling query expression: 
'DbSet<ApprovalRequest>()
    .Where(approval => approval.Steps
        .Any(step => step.ApproverEmployeeNumber == __userId_0))
    .Include(approval => approval.Steps)
    .Select(r => new ApprovalRequestWithCurrentStepDto{ 
        ApprovalId = r.ApprovalId, 
        RequestTitle = r.RequestTitle, 
        RequestedAt = r.RequestedAt, 
        RespondedAt = r.RespondedAt, 
        ApplicantEmployeeNumber = r.ApplicantEmployeeNumber, 
        ApplicantDepartment = r.ApplicantDepartment, 
        ApplicantName = r.ApplicantName, 
        ApplicantPosition = r.ApplicantPosition, 
        Status = r.Status, 
        Steps = r.Steps, 
        CurrentStep = r.CurrentStep, 
        CurrentApproverName = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverName)
            .FirstOrDefault(), 
        CurrentApproverEmployeeNumber = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ApproverEmployeeNumber)
            .FirstOrDefault(), 
        CurrentActionStatus = r.Steps
            .Where(s => s.Sequence == r.CurrentStep)
            .Select(s => s.ActionStatus)
            .FirstOrDefault() 
    }
    )'
2025-06-15 20:42:30.915 +09:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApprovalRequestWithCurrentStepDto>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> 8
            9 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: ApprovalStep.ActionDate (DateTime?), 10], [Property: ApprovalStep.ActionStatus (string), 11], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 12], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 13], [Property: ApprovalStep.ApproverName (string), 14], [Property: ApprovalStep.Comment (string), 15], [Property: ApprovalStep.Department (string), 16], [Property: ApprovalStep.IsFinalApprover (bool) Required, 17], [Property: ApprovalStep.Position (string), 18], [Property: ApprovalStep.Sequence (int) Required, 19], [Property: ApprovalStep.StepType (string), 20] }
            10 -> 9
            11 -> 21
            12 -> 22
            13 -> 23
            14 -> 24
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantDepartment, a.ApplicantName, a.ApplicantPosition, a.Status, a1.StepId, a1.ActionDate, a1.ActionStatus, a1.ApprovalId, a1.ApproverEmployeeNumber, a1.ApproverName, a1.Comment, a1.Department, a1.IsFinalApprover, a1.Position, a1.Sequence, a1.StepType, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE EXISTS (
            SELECT 1
            FROM ApprovalSteps AS a0
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a0.ApprovalId)) && (a0.ApproverEmployeeNumber == @__userId_0))
        ORDER BY a.ApprovalId ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
            7 -> 7
            8 -> 8
            9 -> Dictionary<IProperty, int> { [Property: ApprovalStep.StepId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: ApprovalStep.ActionDate (DateTime?), 10], [Property: ApprovalStep.ActionStatus (string), 11], [Property: ApprovalStep.ApprovalId (Guid) Required FK Index, 12], [Property: ApprovalStep.ApproverEmployeeNumber (string) Required, 13], [Property: ApprovalStep.ApproverName (string), 14], [Property: ApprovalStep.Comment (string), 15], [Property: ApprovalStep.Department (string), 16], [Property: ApprovalStep.IsFinalApprover (bool) Required, 17], [Property: ApprovalStep.Position (string), 18], [Property: ApprovalStep.Sequence (int) Required, 19], [Property: ApprovalStep.StepType (string), 20] }
            10 -> 9
            11 -> 21
            12 -> 22
            13 -> 23
            14 -> 24
        SELECT a.ApprovalId, a.RequestTitle, a.RequestedAt, a.RespondedAt, a.ApplicantEmployeeNumber, a.ApplicantDepartment, a.ApplicantName, a.ApplicantPosition, a.Status, a1.StepId, a1.ActionDate, a1.ActionStatus, a1.ApprovalId, a1.ApproverEmployeeNumber, a1.ApproverName, a1.Comment, a1.Department, a1.IsFinalApprover, a1.Position, a1.Sequence, a1.StepType, a.CurrentStep, (
            SELECT TOP(1) a2.ApproverName
            FROM ApprovalSteps AS a2
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a2.ApprovalId)) && (a2.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a3.ApproverEmployeeNumber
            FROM ApprovalSteps AS a3
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a3.ApprovalId)) && (a3.Sequence == a.CurrentStep)), (
            SELECT TOP(1) a4.ActionStatus
            FROM ApprovalSteps AS a4
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a4.ApprovalId)) && (a4.Sequence == a.CurrentStep))
        FROM ApprovalRequests AS a
        LEFT JOIN ApprovalSteps AS a1 ON a.ApprovalId == a1.ApprovalId
        WHERE EXISTS (
            SELECT 1
            FROM ApprovalSteps AS a0
            WHERE ((a.ApprovalId != NULL) && (a.ApprovalId == a0.ApprovalId)) && (a0.ApproverEmployeeNumber == @__userId_0))
        ORDER BY a.ApprovalId ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Guid? value1;
            string value2;
            DateTime? value3;
            DateTime? value4;
            string value5;
            string value6;
            string value7;
            string value8;
            string value9;
            List<ApprovalStep> namelessParameter{0};
            int? value11;
            string value12;
            string value13;
            string value14;
            value1 = (Guid?)dataReader.GetGuid(0);
            value2 = dataReader.GetString(1);
            value3 = (DateTime?)dataReader.GetDateTime(2);
            value4 = dataReader.IsDBNull(3) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(3);
            value5 = dataReader.GetString(4);
            value6 = dataReader.IsDBNull(5) ? default(string) : dataReader.GetString(5);
            value7 = dataReader.GetString(6);
            value8 = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
            value9 = dataReader.GetString(8);
            namelessParameter{0} = ShaperProcessingExpressionVisitor.InitializeCollection<ApprovalStep, List<ApprovalStep>>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApprovalRequest, List<ApprovalStep>, ApprovalStep> | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalRequest").FindNavigation("Steps").GetCollectionAccessor()]);
            value11 = (int?)dataReader.GetInt32(21);
            value12 = dataReader.IsDBNull(22) ? default(string) : dataReader.GetString(22);
            value13 = dataReader.IsDBNull(23) ? default(string) : dataReader.GetString(23);
            value14 = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
            return resultContext.Values = new object[]
            { 
                (object)value1, 
                value2, 
                (object)value3, 
                (object)value4, 
                value5, 
                value6, 
                value7, 
                value8, 
                value9, 
                namelessParameter{0}, 
                (object)value11, 
                value12, 
                value13, 
                value14 
            };
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateCollection<List<ApprovalStep>, ApprovalStep, ApprovalStep>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(9) ? default(Guid?) : (Guid?)dataReader.GetGuid(9) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApprovalStep entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    ApprovalStep instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(ApprovalStep);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: ApprovalStep.StepId PK | Resolver: c => c.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep").FindPrimaryKey()], 
                        keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetGuid(9) }, 
                        throwOnNullKey: False, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (ApprovalStep)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]: 
                                {
                                    return 
                                    {
                                        ApprovalStep instance;
                                        instance = new ApprovalStep();
                                        instance.<StepId>k__BackingField = dataReader.IsDBNull(9) ? default(Guid) : dataReader.GetGuid(9);
                                        instance.<ActionDate>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                        instance.<ActionStatus>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                        instance.<ApprovalId>k__BackingField = dataReader.IsDBNull(12) ? default(Guid) : dataReader.GetGuid(12);
                                        instance.<ApproverEmployeeNumber>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                        instance.<ApproverName>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        instance.<Comment>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                        instance.<Department>k__BackingField = dataReader.IsDBNull(16) ? default(string) : dataReader.GetString(16);
                                        instance.<IsFinalApprover>k__BackingField = dataReader.IsDBNull(17) ? default(bool) : dataReader.GetBoolean(17);
                                        instance.<Position>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                        instance.<Sequence>k__BackingField = dataReader.IsDBNull(19) ? default(int) : dataReader.GetInt32(19);
                                        instance.<StepType>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApprovalStep | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("ApprovalService.Domain.Entities.ApprovalStep")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApprovalStep)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                return entity;
            });
        return IsTrue(resultCoordinator.ResultReady)
         ? new ApprovalRequestWithCurrentStepDto{ 
            ApprovalId = (Guid)(Guid?)(resultContext.Values[0]), 
            RequestTitle = (string)(resultContext.Values[1]), 
            RequestedAt = (DateTime)(DateTime?)(resultContext.Values[2]), 
            RespondedAt = (DateTime?)(resultContext.Values[3]), 
            ApplicantEmployeeNumber = (string)(resultContext.Values[4]), 
            ApplicantDepartment = (string)(resultContext.Values[5]), 
            ApplicantName = (string)(resultContext.Values[6]), 
            ApplicantPosition = (string)(resultContext.Values[7]), 
            Status = (string)(resultContext.Values[8]), 
            Steps = (List<ApprovalStep>)(resultContext.Values[9]), 
            CurrentStep = (int)(int?)(resultContext.Values[10]), 
            CurrentApproverName = (string)(resultContext.Values[11]), 
            CurrentApproverEmployeeNumber = (string)(resultContext.Values[12]), 
            CurrentActionStatus = (string)(resultContext.Values[13]) 
        }
         : default(ApprovalRequestWithCurrentStepDto);
    }, 
    contextType: ApprovalService.Infrastructure.Persistence.ApprovalDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-15 20:42:30.924 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:30.924 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:42:30.925 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:30.925 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:30.925 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:42:30.926 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:30.926 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:30.926 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:42:30.930 +09:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantDepartment", "a"."ApplicantName", "a"."ApplicantPosition", "a"."Status", "a1"."StepId", "a1"."ActionDate", "a1"."ActionStatus", "a1"."ApprovalId", "a1"."ApproverEmployeeNumber", "a1"."ApproverName", "a1"."Comment", "a1"."Department", "a1"."IsFinalApprover", "a1"."Position", "a1"."Sequence", "a1"."StepType", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE EXISTS (
    SELECT 1
    FROM "ApprovalSteps" AS "a0"
    WHERE "a"."ApprovalId" = "a0"."ApprovalId" AND "a0"."ApproverEmployeeNumber" = @__userId_0)
ORDER BY "a"."ApprovalId"
2025-06-15 20:42:30.933 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:30.933 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:30.934 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:30.934 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 3ms reading results.
2025-06-15 20:42:30.934 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:30.934 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:30.934 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:42:30.934 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:42:30.934 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:42:30.934 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:42:30.934 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:42:30.935 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:42:30.935 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API) in 63.9226ms
2025-06-15 20:42:30.935 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalController.GetMyApprovals (ApprovalService.API)'
2025-06-15 20:42:30.935 +09:00 [DBG] Connection id "0HNDC06QKPPHF" completed keep alive response.
2025-06-15 20:42:30.935 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:42:30.935 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:30.936 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:30.936 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approval/my-approvals/EC20505 - 200 null application/json; charset=utf-8 71.3304ms
2025-06-15 20:42:31.909 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - null null
2025-06-15 20:42:31.912 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:42:31.912 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:42:31.912 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:31.914 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:42:31.914 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:31.915 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 20:42:31.915 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:42:31.915 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:42:31.915 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:42:31.915 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:42:31.915 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:42:31.916 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:42:31.916 +09:00 [INF] Initializing ApprovalRequestController
2025-06-15 20:42:31.916 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:42:31.916 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 20:42:31.916 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 20:42:31.916 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:42:31.916 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:42:31.916 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 20:42:31.917 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 20:42:31.917 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:42:31.922 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:31.922 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:42:31.922 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:31.923 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:31.923 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:42:31.923 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:31.923 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:31.923 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:42:31.925 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:42:31.927 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.928 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.929 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.929 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.929 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.929 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.929 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.930 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.930 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.930 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:31.930 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:31.930 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 4ms reading results.
2025-06-15 20:42:31.930 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:31.930 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:31.931 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:42:31.931 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:42:31.931 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:42:31.931 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:42:31.931 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:42:31.931 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:42:31.932 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 16.0638ms
2025-06-15 20:42:31.932 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:31.932 +09:00 [DBG] Connection id "0HNDC06QKPPHF" completed keep alive response.
2025-06-15 20:42:31.932 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:42:31.932 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:31.932 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:31.932 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - 200 null application/json; charset=utf-8 23.4005ms
2025-06-15 20:42:33.177 +09:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - null null
2025-06-15 20:42:33.177 +09:00 [DBG] 1 candidate(s) found for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:42:33.177 +09:00 [DBG] Endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)' with route pattern 'api/ApprovalRequest/my-requests/{userId}' is valid for the request path '/api/approvalrequest/my-requests/EC20505'
2025-06-15 20:42:33.177 +09:00 [DBG] Request matched endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:33.178 +09:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-15 20:42:33.178 +09:00 [INF] Executing endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:33.179 +09:00 [INF] Route matched with {action = "GetMyRequests", controller = "ApprovalRequest"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyRequests(System.String) on controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API).
2025-06-15 20:42:33.179 +09:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-15 20:42:33.179 +09:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-15 20:42:33.180 +09:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-15 20:42:33.180 +09:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-15 20:42:33.180 +09:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-15 20:42:33.180 +09:00 [DBG] Executing controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:42:33.184 +09:00 [INF] Initializing ApprovalRequestController
2025-06-15 20:42:33.184 +09:00 [DBG] Executed controller factory for controller ApprovalService.API.Controllers.ApprovalRequestController (ApprovalService.API)
2025-06-15 20:42:33.184 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' ...
2025-06-15 20:42:33.184 +09:00 [DBG] Attempting to bind parameter 'userId' of type 'System.String' using the name 'userId' in request data ...
2025-06-15 20:42:33.184 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:42:33.185 +09:00 [DBG] Done attempting to bind parameter 'userId' of type 'System.String'.
2025-06-15 20:42:33.185 +09:00 [DBG] Attempting to validate the bound parameter 'userId' of type 'System.String' ...
2025-06-15 20:42:33.185 +09:00 [DBG] Done attempting to validate the bound parameter 'userId' of type 'System.String'.
2025-06-15 20:42:33.186 +09:00 [DBG] Entity Framework Core 9.0.5 initialized 'ApprovalDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.5' with options: None
2025-06-15 20:42:33.187 +09:00 [DBG] Creating DbConnection.
2025-06-15 20:42:33.187 +09:00 [DBG] Created DbConnection. (0ms).
2025-06-15 20:42:33.187 +09:00 [DBG] Opening connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:33.187 +09:00 [DBG] Opened connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:33.187 +09:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-15 20:42:33.187 +09:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:33.187 +09:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-06-15 20:42:33.187 +09:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:42:33.188 +09:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."ApprovalId", "a"."RequestTitle", "a"."RequestedAt", "a"."RespondedAt", "a"."ApplicantEmployeeNumber", "a"."ApplicantName", "a"."ApplicantDepartment", "a"."ApplicantPosition", "a0"."StepId", "a0"."ActionDate", "a0"."ActionStatus", "a0"."ApprovalId", "a0"."ApproverEmployeeNumber", "a0"."ApproverName", "a0"."Comment", "a0"."Department", "a0"."IsFinalApprover", "a0"."Position", "a0"."Sequence", "a0"."StepType", "a1"."AttachmentId", "a1"."ApprovalId", "a1"."FileName", "a1"."FilePath", "a1"."FileSize", "a1"."FileType", "a1"."UploadedAt", "a1"."UploadedByEmployeeNumber", "a"."Status", "a"."CurrentStep", (
    SELECT "a2"."ApproverName"
    FROM "ApprovalSteps" AS "a2"
    WHERE "a"."ApprovalId" = "a2"."ApprovalId" AND "a2"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a3"."ApproverEmployeeNumber"
    FROM "ApprovalSteps" AS "a3"
    WHERE "a"."ApprovalId" = "a3"."ApprovalId" AND "a3"."Sequence" = "a"."CurrentStep"
    LIMIT 1), (
    SELECT "a4"."ActionStatus"
    FROM "ApprovalSteps" AS "a4"
    WHERE "a"."ApprovalId" = "a4"."ApprovalId" AND "a4"."Sequence" = "a"."CurrentStep"
    LIMIT 1)
FROM "ApprovalRequests" AS "a"
LEFT JOIN "ApprovalSteps" AS "a0" ON "a"."ApprovalId" = "a0"."ApprovalId"
LEFT JOIN "ApprovalAttachments" AS "a1" ON "a"."ApprovalId" = "a1"."ApprovalId"
WHERE "a"."ApplicantEmployeeNumber" = @__userId_0
ORDER BY "a"."RequestedAt" DESC, "a"."ApprovalId", "a0"."StepId"
2025-06-15 20:42:33.189 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.189 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.189 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.189 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.190 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.190 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.190 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.190 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.190 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalStep' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.191 +09:00 [DBG] Context 'ApprovalDbContext' started tracking 'ApprovalAttachment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-15 20:42:33.191 +09:00 [DBG] Closing data reader to 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:33.191 +09:00 [DBG] A data reader for 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db' is being disposed after spending 2ms reading results.
2025-06-15 20:42:33.191 +09:00 [DBG] Closing connection to database 'main' on server '/Users/7ames7in/Documents/GitHub/New-Projects/NewApprovalSystem/src/Services/ApprovalService/API/Data/ApprovalService.db'.
2025-06-15 20:42:33.192 +09:00 [DBG] Closed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:33.192 +09:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-15 20:42:33.192 +09:00 [DBG] No information found on request to perform content negotiation.
2025-06-15 20:42:33.192 +09:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-15 20:42:33.193 +09:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-15 20:42:33.193 +09:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-15 20:42:33.193 +09:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ApprovalService.Domain.Entities.ApprovalRequestWithCurrentStepDto, ApprovalService.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-15 20:42:33.194 +09:00 [INF] Executed action ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API) in 13.7951ms
2025-06-15 20:42:33.194 +09:00 [INF] Executed endpoint 'ApprovalService.API.Controllers.ApprovalRequestController.GetMyRequests (ApprovalService.API)'
2025-06-15 20:42:33.194 +09:00 [DBG] Connection id "0HNDC06QKPPHF" completed keep alive response.
2025-06-15 20:42:33.194 +09:00 [DBG] 'ApprovalDbContext' disposed.
2025-06-15 20:42:33.194 +09:00 [DBG] Disposing connection to database 'main' on server 'Data/ApprovalService.db'.
2025-06-15 20:42:33.195 +09:00 [DBG] Disposed connection to database 'main' on server 'Data/ApprovalService.db' (0ms).
2025-06-15 20:42:33.195 +09:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/approvalrequest/my-requests/EC20505 - 200 null application/json; charset=utf-8 18.1836ms
2025-06-15 20:43:44.288 +09:00 [DBG] Connection id "0HNDC06QKPPHF" received FIN.
2025-06-15 20:43:44.293 +09:00 [DBG] Connection id "0HNDC06QKPPHF" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-15 20:43:44.296 +09:00 [DBG] Connection id "0HNDC06QKPPHF" disconnecting.
2025-06-15 20:43:44.298 +09:00 [DBG] Connection id "0HNDC06QKPPHF" stopped.
